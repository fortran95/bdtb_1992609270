_.Module.define({path:"common/widget/search/ProductButton",sub:{_forum:"",_product:"",_firClass:"",_secClass:"",_loginState:false,_configURL:"http://ti^^eba.ba^^idu.com/tb/poptipconfig.js".replace(/\^/g,"")+"?t="+(new Date().getHours()),initial:function(b,e,d,c,a){this._forum=b;this._product=e.toLowerCase();this._firClass=d;this._secClass=c;this._loginState=a},renderButton:function(){var a=this;if(typeof ProductButtonConfig!="undefined"){a._initRender()}else{$.JsLoadManager.use(a._configURL,function(){if(typeof ProductButtonConfig!="undefined"){a._initRender()}})}},doAfterRender:function(a){},_initRender:function(){var a=this;if($.isArray(ProductButtonConfig)){var b=a._parseOptions(ProductButtonConfig);if(!b){a.doAfterRender(false);return}a._render(b);a.doAfterRender(true)}else{a.doAfterRender(false)}},_parseOptions:function(b){var k={width:0,height:0,src:"",link:"",pv:"",offset:{top:0,left:0}},c;var e=false;if(!b||!$.isArray(b)||b.length<=0){return null}for(var g=0;g<b.length;g++){var h=b[g];if(h.hasOwnProperty("login_state")&&typeof h.login_state=="boolean"){if(this._loginState!==h.login_state){continue}}if(h.page){var j=h.page;if(!this._checkInfo(this._product,h.page)){continue}}if(this._product&&$.inArray(this._product,["frs","pb"])>=0){if(!this._checkInfo(this._forum,h.forum)){continue}if(!this._checkInfo(this._firClass,h.fir_class)&&!this._checkInfo(this._secClass,h.sec_class)){continue}}if(!h.hasOwnProperty("start_time")||!h.hasOwnProperty("end_time")||h.start_time==""||h.end_time==""){continue}var a=this._dateParse(h.start_time).getTime(),f=this._dateParse(h.end_time).getTime(),d=new Date().getTime();if(a>=f||d<a||d>f){continue}else{e=true;c=_.extend(k,{});_.extend(c,h)}}if(e){return c}else{return null}},_checkInfo:function(b,a){if(a&&$.isArray(a)&&a.length>0&&$.inArray(b,a)<0){return false}return true},_render:function(c){var b=$("#head");if(b.length<=0){return}var a="";if(c.pv){a="onclick=\"$.stats.sendRequest('"+c.pv+"');\""}b.append("<a "+a+' style="display:block;overflow:hidden;zoom:1;z-index:1;position:absolute;top:'+c.offset.top+"px;left:"+c.offset.left+"px;background:url("+c.src+") 0px 0px no-repeat;_background:none;_filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+c.src+"',enabled=true);width:"+c.width+"px;height:"+c.height+'px;cursor:pointer;" href="'+c.link+'" target="_blank"><div style="position:relative;width:'+c.width+"px;height:"+c.height+'px;cursor:pointer;"></div></a>')},_dateParse:function(b){if(typeof b=="string"){var a=b.match(/^ *(\d{4})-(\d{1,2})-(\d{1,2}) *$/);if(a&&a.length>3){return new Date((1*a[1]),(1*a[2])-1,(1*a[3]))}a=b.match(/^ *(\d{4})-(\d{1,2})-(\d{1,2}) +(\d{1,2}):(\d{1,2}):(\d{1,2}) *$/);if(a&&a.length>6){return new Date((1*a[1]),(1*a[2])-1,(1*a[3]),(1*a[4]),(1*a[5]),(1*a[6]))}a=b.match(/^ *(\d{4})-(\d{1,2})-(\d{1,2}) +(\d{1,2}):(\d{1,2}):(\d{1,2})\.(\d{1,9}) *$/);if(a&&a.length>7){return new Date((1*a[1]),(1*a[2])-1,(1*a[3]),(1*a[4]),(1*a[5]),(1*a[6]),(1*a[7]))}}return null}}});