window.CommonUiDecorator=function(){this._priorityConfig={"default":0,hover:1,active:1,focus:2,error:10}};window.CommonUiDecorator.prototype={processEffect:function(c,e,b,d){var a=new RegExp("(^|\\s)"+e+"\\S+","g");if(c.getAttribute("effect_pri")<=this._priorityConfig[b]){c.className=c.className.replace(a,"")+" "+e+d;c.setAttribute("effect_pri",this._priorityConfig[d])}},clearEffect:function(a,b){this.forceEffect(a,b,"default")},forceEffect:function(c,d,b){var a=new RegExp("(^|\\s)"+d+"\\S+","g");c.className=c.className.replace(a,"")+" "+d+b;c.setAttribute("effect_pri",this._priorityConfig[b])},addEffects:function(f,g,e){var d,h;var b=this;if(f.size()>0){if(e==null){e=[]}for(var c=0,a=e.length;c<a;c++){switch(e[c]){case"hover":f.hover(function(){b.processEffect(this,g,"hover","hover")},function(){b.processEffect(this,g,"hover","default")});break;case"active":f.mousedown(function(){b.processEffect(this,g,"active","active")}).mouseup(function(){b.processEffect(this,g,"active","default")});break;case"focus":f.focus(function(){b.processEffect(this,g,"focus","focus")}).blur(function(){b.processEffect(this,g,"focus","default")});break}}}}};var TbMsgSys;(function(){var a={};a.Type=function(c,e){var b=this;this.name={};this.body={};var d=function(){b.name=c;for(var f in e){b.body[f]=true}};d()};a.TypeManager=new (function(){var b={};this.addType=function(c,d){if(b[c]){return false}b[c]=new a.Type(c,d);return true};this.removeType=function(c){if(b.hasOwnProperty(c)){b[c]=null;delete b[c]}};this.getType=function(c){if(b[c]){return b[c]}else{return null}}})();a.CheckBox=function(){var b=a.TypeManager;this.checkMsg=function(f){var d=true;if(!f||!f.hasOwnProperty("head")||!f.hasOwnProperty("body")||!f.head.type){alert("消息不完整");return false}var e=b.getType(f.head.type);if(!e){alert("消息类型不存在！");return false}for(var c in e.body){if(!f.body.hasOwnProperty(c)){alert("消息体结构不完整！");d=false;break}}return d}};a.Setup=function(){var b=this;var c=new a.CheckBox();this.setType=function(e,d){e.head.type=d;return e};this.setTo=function(e,f){var d=$.extend({},e);d.head.to=f;return d};this.setFrom=function(e,f){var d=$.extend({},e);d.head.from=f;return d};this.setBody=function(f,e){var d=$.extend({},f);d.body=e;if(c.checkMsg(d)){return d}else{return false}};this.set=function(f,e,i,h,d){var g=b.setType(f,e);g=b.setFrom(f,i);g=b.setTo(f,h);g=b.setBody(f,d);return g}};a.Assembly=new (function(){var c=a.TypeManager;var b=new a.CheckBox();var d=new a.Setup();this.typeManager=function(){return c},this.checkBox=function(){return b},this.setup=function(){return d}})();a.Message=function(){var b=this;this.head={type:"default",from:"",to:""},this.body={};this.getType=function(){return b.head.type};this.getFrom=function(){return b.head.from};this.getTo=function(){return b.head.to}};a.Generator=function(){var b=a.Assembly;this.getNewMessage=function(d,g,f,c){var e=new a.Message();return b.setup().set(e,d,g,f,c)}};a.MsgQue=function(h,e){var c,f,d=0,b=this;var g=function(){f=new Array();d=e;c=h};this.add=function(i){if(!b.isFull()){f.push(i)}};this.get=function(){if(!b.isEmpty()){return f.shift()}else{return null}};this.isEmpty=function(){return !(f.length>0)};this.isFull=function(){return !!(d>0&&f.length>=d)};this.getSize=function(){return f.length};this.pop=function(){f.pop()};this.getId=function(){return c};this.clear=function(){f=new Array()};g()};a.processor=function(){var b=false,d=null,c={};this.process=function(i){d=i;b=true;var h=i.getType(),f=i.getTo(),e=i.getFrom();if(c.hasOwnProperty(h)&&typeof c[h]=="function"){var g=c[h].call(i,h,f,e,i.body);d=null;b=false;return g}d=null;b=false;return false};this.setProcess=function(f,e){c[f]=e};this.getCurrentMsg=function(){return d}};a.Server=function(f){var c=f,b=a.Assembly,e={},d=new a.processor();this.recieve=function(g){return d.process(g)};this.sendToQueue=function(h){var g=h.getTo();if(!e.hasOwnProperty(g)||!e[g]){e[g]=new a.MsgQue(g)}e[g].add(h)};this.getMsgQueues=function(){return e};this.setProcessor=function(h,g){d.setProcess(h,g)}};a.Servers=new (function(){var b={},c=a.Assembly;this.addServer=function(d){if(!b.hasOwnProperty(d)||!b[d]){b[d]=new a.Server(d)}},this.getServer=function(d){return(b[d]||null)};this.getAllServer=function(){return b};this.removeServer=function(d){delete b[d]}})();a.Distributor=new (function(){var c=a.Servers,b=a.Assembly;this.distribute=function(f){if(!b.checkBox().checkMsg(f)){return false}var e=c.getServer(f.getTo()),d=c.getServer(f.getFrom());if(!e){d.sendToQueue(f);return false}else{return this.recieve(f)}};this.recieve=function(e){var d=c.getServer(e.getTo());if(d){return d.recieve(e)}else{return false}}})();a.MsgManager=new (function(){var d=a.Assembly,e=new a.Generator(),b=a.Servers,h=a.Distributor,i=this;var j={system:{state:true,msg:true}};var g=function(){for(var k in j){i.addMsgType(k,j[k])}};var f=function(l,q,o,p){if(l=="system"&&p.state=="init"){var k=b.getServer(q),r=k.getMsgQueues();for(var m in r){var n=r[m];if(!n||n.isEmpty()){continue}c(n)}}};var c=function(k){if(!k.isEmpty()){var l=k.get();h.distribute(l);setTimeout(function(){c(k)},50)}};this.addMsgType=function(k,l){d.typeManager().addType(k,l)};this.removeMsgType=function(k){d.typeManager().removeType(k)};this.checkMsg=function(k){return d.checkBox().checkMsg(k)};this.sendMsg=function(k,o,n,l){var m=e.getNewMessage(k,o,n,l);if(m){return h.distribute(m)}else{return false}};this.sendMsgToAll=function(k,p,n){var l=b.getAllServer();for(var m in l){if(m==p){continue}var o=e.getNewMessage(k,p,m,n);if(o){h.distribute(o)}}};this.setProcessor=function(l,n,m){var k=b.getServer(l);if(!k){return false}k.setProcessor(n,m);return true};this.registerServer=function(k){b.addServer(k);this.setProcessor(k,"system",f)};this.initedServer=function(k){this.sendMsgToAll("system",k,{state:"init",msg:true})};g()})();TbMsgSys=a.MsgManager})();var TbCom;var TbComMsName="ComManager";var MsgSystem=MsgSystem||{need_start:true};(function(){var b=null;var f=typeof _VERSION==="undefined"?{}:_VERSION;var a={staticVersion:9.21,comlist:{PassportFillName:{inited:false,loaded:false,url:"/tb/static-common/"+(f["component/commonLogic/common/passport/PassportFillName.js"]||"component/commonLogic/common/passport/PassportFillName.js")},PassportSign:{inited:false,loaded:false,url:"/tb/static-common/"+(f["component/commonLogic/common/passport/PassportLogin.js"]||"component/commonLogic/common/passport/PassportLogin.js")},PassportRegister:{inited:false,loaded:false,url:"/tb/static-common/"+(f["component/commonLogic/common/passport/PassportRegister.js"]||"component/commonLogic/common/passport/PassportRegister.js")},User:{inited:false,loaded:false,url:"/tb/static-common/"+(f["component/commonLogic/common/user/User.js"]||"component/commonLogic/common/user/User.js")},UserBar:{inited:false,loaded:false,url:"/tb/static-common/"+(f["component/commonLogic/common/user/UserBar.js"]||"component/commonLogic/common/user/UserBar.js")},Suggestion:{inited:false,loaded:false,url:"/tb/static-common/"+(f["component/commonLogic/common/suggestion/Suggestion.js"]||"component/commonLogic/common/suggestion/Suggestion.js")},Poptip:{inited:false,loaded:false,url:"/tb/static-common/"+(f["component/commonLogic/common/poptip/Poptip.js"]||"component/commonLogic/common/poptip/Poptip.js")},WealthSystem:{inited:false,loaded:false,url:"/tb/static-common/"+(f["component/commonLogic/common/wealth/WealthSystem.js"]||"component/commonLogic/common/wealth/WealthSystem.js")},Search:{inited:false,loaded:true,url:"/tb/static-common/"+(f["component/commonLogic/common/search/Search.js"]||"component/commonLogic/common/search/Search.js")},MsgSystem:{inited:false,loaded:false,url:"/tb/static-common/"+(f["component/commonLogic/common/crosspage_msg_system/MsgSystem.js"]||"component/commonLogic/common/crosspage_msg_system/MsgSystem.js")},UserMessage:{inited:false,loaded:false,url:"/tb/static-common/"+(f["component/commonLogic/common/user_message/UserMessage.js"]||"component/commonLogic/common/user_message/UserMessage.js")}},defualtMerger:["User","UserBar","Suggestion","Poptip","WealthSystem"],defaultMergerURL:"/tb/static-common/"+(f["component/commonLogic/common/common_default_merger.js"]||"component/commonLogic/common/common_default_merger.js"),error:{SUCCESS:0,COM_NOT_FOUND:1,METHOD_NOT_FOUND:2,PROCESS_ERROR:3}};var g=function(i,h){var k=i;var j=h;this.error=function(){return k};this.result=function(){return j}};var e=function(){var h=arguments[0];this.createPars=function(k){var j=[];for(var l=k;l<h.length;l++){j.push(h[l])}return j}};var d=new (function(){this.process=function(){if(arguments.length<2){return new g(a.error.PROCESS_ERROR)}var k=arguments[0],i=arguments[1];if(!k||!a.comlist[k]["inited"]){return new g(a.error.COM_NOT_FOUND)}if(!k.hasOwnProperty(i)||typeof k[i]!="function"){return new g(a.error.METHOD_NOT_FOUND)}var h=new e(arguments).createPars(2);var j=TbMsgSys.sendMsg("process",TbComMsName,k,{method:arguments[1],params:h});return new g(a.error.SUCCESS,j)}})();var c=new (function(){var p=a,h={};var q={User:true,UserBar:true,Suggestion:true,Poptip:true,MsgSystem:true,UserMessage:true};var n=function(){var u={process:{method:true,params:true},loadCom:{com:true},needCom:{coms:true}};TbMsgSys.registerServer(TbComMsName);for(var t in u){TbMsgSys.addMsgType(t,u[t])}TbMsgSys.setProcessor(TbComMsName,"loadCom",m);TbMsgSys.setProcessor(TbComMsName,"needCom",k);TbMsgSys.initedServer(TbComMsName);$.console.debug("模块："+TbComMsName+" 激活！");$.console.debug("模块："+TbComMsName+" 激活！准备开始加载默认合并静态文件!");$(s)};var s=function(){var v=p.comlist;var w=p.defualtMerger;var t=p.defaultMergerURL;$.JsLoadManager.use(t+"?v="+a.staticVersion);for(var u=0;u<w.length;u++){v[w[u]]["loaded"]=true}};var k=function(t,y,v,w){var x=w.coms;if(x&&(x.length>0||!r(x))){h[v]=x;for(var u=0;u<x.length;u++){l(x[u])}}else{i(v)}};var i=function(t){p.comlist[t]["inited"]=true;TbMsgSys.initedServer(t);$.console.debug("模块："+t+" 激活！");d.process(t,"init");delete h[t]};var m=function(x,t,w,u,v){l(v.com)};var o=function(t){j(t)};var j=function(t){for(var u in h){if($.inArray(t,h[u])>=0&&r(h[u])){i(u);arguments.callee(u)}}};var r=function(v){var t=true;for(var u=0;u<v.length;u++){if(!p.comlist.hasOwnProperty(v[u])){return false}if(!p.comlist[v[u]]["inited"]){t=false;break}}return t};var l=function(t){if(!p.comlist.hasOwnProperty(t)||!p.comlist[t]["url"]){$.console.error("配置中找不到模块 : "+t);return}if($.inArray(t,p.defualtMerger)>=0){$.console.log("该模块在默认合并文件中，不做单独加载 : "+t);return}if(p.comlist[t]["loaded"]){return}$.JsLoadManager.use(p.comlist[t]["url"]+"?v="+a.staticVersion,function(){o(t)});p.comlist[t]["loaded"]=true};this.process=function(u,w,v){l(u);var t=new e(arguments).createPars(2);return TbMsgSys.sendMsg("process",TbComMsName,u,{method:w,params:t})};this.addEvent=function(t,u,v){return this.process(t,"addEvent",u,v)};this.removeEvent=function(t,u,v){return this.process(t,"removeEvent",u,v)};this.setNeedStartConfig=function(t){if(t&&typeof t=="object"){$.extend(q,t)}};this.defaultLogicInit=function(w,y,x,u,t){var v=u||null;if(typeof t!="undefined"){a.staticVersion=t}this.setNeedStartConfig(x);if(q.User){this.process("User","init",w,y);if(q.UserBar){this.process("UserBar","init",v)}}if(q.Suggestion){this.process("Suggestion","createMainSearchSuggestion")}if(q.Poptip){this.process("Poptip","init","http://tie^ba.b^aidu.com/tb/poptipconfig.js".replace(/\^/g,""),v)}if(w.is_login&&!w.no_un&&q.MsgSystem&&(!MsgSystem||!MsgSystem.hasOwnProperty("need_start")||MsgSystem.need_start===true)){this.process("MsgSystem","init");if(q.UserMessage){this.process("UserMessage","init",y,v)}}};n()})();TbCom=c})();var TbICom=function(){var d=false,c,b=this;var a=[];var e;this.processMsgHandler=function(f,k,i,j){var g=j.params,h=j.method;if(!e[h]||typeof e[h]!="function"){$.console.error("找不到方法: "+h);return false}return e[h].apply(b,g)};this.initSys=function(h,g,f){if(d){return}c=h;$.extend(e,f);a=g;TbMsgSys.registerServer(c);TbMsgSys.setProcessor(c,"process",this.processMsgHandler);TbMsgSys.sendMsg("needCom",c,"ComManager",{coms:a});d=true;$.console.debug("模块: "+h+" initSys！依赖："+g)};this.init=function(){};this.getRelationship=function(){return a};this.getId=function(){return c};this.getInited=function(){return d};this.addEvent=function(f,g){$(b).bind(f,g)};this.removeEvent=function(f,g){$(b).unbind(f,g)};this.dispatchEvent=function(){$(b).trigger.apply($(b),arguments)};e={init:this.init,addEvent:this.addEvent,removeEvent:this.removeEvent,dispatchEvent:this.dispatchEvent,getId:this.getId,getRelationship:this.getRelationship,getInited:this.getInited}};var TbUtil={addStamp:function(a){return a+(a.indexOf("?")==-1?"?":"&t=")+new Date().getTime().toString(32)},toQueryString:function(b){var c=[];for(var a in b){c.push(encodeURIComponent(a)+"="+encodeURIComponent(b[a]))}return c.join("&")},selectAll:function(g,e,f){var d=document.getElementById(g);if(d){var b=d.getElementsByTagName("input");for(var c=0,a=b.length;c<a;c++){if(b[c].getAttribute("name")==e){b[c].checked=f.checked}}b=null}},getCheckedValue:function(a,g,e){var h=[];e=e||",";var j;var c=document.getElementById(a);if(c){var f=c.getElementsByTagName("input");for(var d=0,b=f.length;d<b;d++){j=f[d];if(j.checked){h.push(j.value)}}f=null}return h.join(e)},G:function(a){return document.getElementById(a)}};TbUtil.trim=function(a){return a.replace(/(^[\s\t\xa0\u3000]+)|([\u3000\xa0\s\t]+$)/g,"")};TbUtil.DBC2SBC=function(c){var b;var a="";for(b=0;b<c.length;b++){str1=c.charCodeAt(b);if(str1<65296){a+=String.fromCharCode(c.charCodeAt(b));continue}if(str1<125&&!flag){a+=String.fromCharCode(c.charCodeAt(b))}else{a+=String.fromCharCode(c.charCodeAt(b)-65248)}}return a};TbUtil.getByteLength=function(a){return a.replace(/[^\x00-\xff]/g,"mm").length};TbUtil.escapeHTML=function(a){return a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")};TbUtil.escapeUTF8=function(a){return escape(String(a)).replace(/%u(\w{4})/g,function(b,c){return encodeURIComponent(String.fromCharCode("0x"+c)).replace(/%/g,"%25")})};TbUtil.resizePic=function(d,a,j,e){var i=a||120;var f=j||120;var c=false;var g=d;if(g.width==0){var h=this;var l=arguments;setTimeout(function(){l.callee.apply(h,l)},100);return false}function k(m,p,n,r){var o=0,q=m,s=p;if(m>n){o+=1}if(p>r){o+=2}switch(o){case 1:q=n;q=p*n/m;case 2:s=r;q=m*r/p;case 3:s=(p/r>m/n)?r:p*n/m;q=(p/r>m/n)?m*r/p:n}if(o!=0){c=true}return[q,s]}var b=k(g.width,g.height,i,f);d.style.width=b[0]+"px";d.style.height=b[1]+"px";d.style.visibility="visible";if(e==true){d.style.marginTop=(j-parseInt(b[1]))/2+"px"}return c};TbUtil.json={};TbUtil.json.encode=(function(){var b={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};function a(f){if(/["\\\x00-\x1f]/.test(f)){f=f.replace(/["\\\x00-\x1f]/g,function(g){var h=b[g];if(h){return h}h=g.charCodeAt();return"\\u00"+Math.floor(h/16).toString(16)+(h%16).toString(16)})}return'"'+f+'"'}function d(m){var g=["["],h=m.length,f,j,k;for(j=0;j<h;j++){k=m[j];switch(typeof k){case"undefined":case"function":case"unknown":break;default:if(f){g.push(",")}g.push(TbUtil.json.encode(k));f=1}}g.push("]");return g.join("")}function c(f){return f<10?"0"+f:f}function e(f){return'"'+f.getFullYear()+"-"+c(f.getMonth()+1)+"-"+c(f.getDate())+"T"+c(f.getHours())+":"+c(f.getMinutes())+":"+c(f.getSeconds())+'"'}return function(j){switch(typeof j){case"undefined":return"undefined";case"number":return isFinite(j)?String(j):"null";case"string":return a(j);case"boolean":return String(j);default:if(j===null){return"null"}else{if(j instanceof Array){return d(j)}else{if(j instanceof Date){return e(j)}else{var g=["{"],i=TbUtil.json.encode,f,h;for(key in j){if(j.hasOwnProperty(key)){h=j[key];switch(typeof h){case"undefined":case"unknown":case"function":break;default:if(f){g.push(",")}f=1;g.push(i(key)+":"+i(h))}}}g.push("}");return g.join("")}}}}}})();TbUtil.json.decode=function(string,secure){if(typeof(string)!="string"||!string.length){return null}if(secure&&!(/^[,:{}\[\]0-9.\-+Eaeflnr-u \n\r\t]*$/).test(string.replace(/\\./g,"@").replace(/"[^"\\\n\r]*"/g,""))){return null}try{return eval("("+string+")")}catch(e){return{}}};TbUtil.showErrorTip=function(e,d,f,a){var c='<div style="padding:20px 20px; text-align:'+f+'; line-height:20px;font-size:13px;">'+d.replace(/\r?\n/gi,"<br>")+"</div>";var b=a||false;if(b){Fe.Dialog.open(c,{title:"",width:200});setTimeout(function(){Fe.Dialog.close()},500)}else{Fe.Dialog.alert(c,{title:e,width:380})}};TbUtil.hiPopHandler=function(a){if(a==0){TbUtil.login()}else{if(a==1||a==3){Fe.Dialog.alertMessageFace("该用户不存在",json._info.replace(/\r?\n/gi,"<br>"),{title:"错误提示",width:350})}}};TbUtil.browser=function(){var c=navigator.userAgent;var d={};var a="",b="";if(c.indexOf("AppleWebKit")>=0){a="webkit"}else{if(c.indexOf("Gecko")>=0){a="gecko"}else{if(c.indexOf("MSIE")>=0){a="ie"}}}if(c.indexOf("Firefox")>=0){b="firefox"}else{if(c.indexOf("360SE")>=0){b="360se"}else{if(c.indexOf("SE")>=0){b="sougou"}else{if(c.indexOf("Maxthon")>=0){b="maxthon"}else{if(c.indexOf("MSIE")>=0){b="ie"}else{if(c.indexOf("Chrome")>=0){b="chrome"}else{if(c.indexOf("Safari")>=0){b="safari"}}}}}}}return{core:a,name:b}};TbUtil.handleError=function(d,e,f,c,a){d.no=d.no||d.error_no;_autoHide=a||false;if(d.no==4){Fe.showLoginLayer(true)}else{var b=e||"操作失败";var f=f||"left";var c=c||d.error||FORUM_ERROR_INFO[d.no]||"操作失败";TbUtil.showErrorTip(b,c,f,_autoHide)}};var PageData=PageData||{};PageData.tbs_loaded=true;TbUtil.requestTbs=function(asyn){if(typeof asyn=="undefined"){asyn=true}if(PageData.tbs_loaded){return}var url=FORUM_POST_URL.get_tbs+"?t="+Math.random();var parmas="";Fe.Ajax.request(url,function(xml){var json=eval("("+xml.responseText+")");if(json.tbs){PageData.tbs=json.tbs;PageData.tbs_loaded=true}else{PageData.tbs=""}},{async:asyn})};String.prototype.trim=function(){var a=this;var b=a.replace(/^\s*|\s*$/g,"");return b};String.prototype.clear=function(){var a=this;var b=a.replace(/\<br[^\>^\<]*\/?\>/gi,"");b=b.replace(/\<p[^\>^\<]*\>(\&nbsp\;)?\<\/p\>|\<p\/?\>/gi,"");return b.trim()};String.prototype.wordLen=function(){var a=this.replace(/[^\x00-\xff]/g,"**");return a.length};String.prototype.wordCut=function(e,b){if(typeof e!="number"||e<0){return}var c=e,h=b||"";var g=this,a=new Array();var f=g.replace(/[^\x00-\xff]/g,function(i){a.push(i);return"*)"});if(f[c-1]&&f[c-1]=="*"&&f[c]==")"){c++}if(c>=f.length){return g}f=f.substr(0,c);var d=0;f=f.replace(/(\*\))/g,function(j){var i=a[d];d++;return i});return f+h};String.prototype.subByte=function(c){if(this.wordLen()<=c){return this}for(var b=Math.floor((c=c-2)/2),a=this.length;b<a;b++){if(this.substr(0,b).wordLen()>=c){return this.substr(0,b)+"\u2026"}}return this};String.prototype.subByte2=function(c){if(this.wordLen()<=c){return this}for(var b=Math.floor((c=c-2)/2),a=this.length;b<a;b++){if(this.substr(0,b).wordLen()>c){return this.substr(0,b)}}return this};String.prototype.subByteFix=function(d,c){if(this.wordLen()<=d){return this}for(var b=Math.floor((d-2)/2),a=this.length;b<a;b++){if(this.substr(0,b).wordLen()>=d){return this.substr(0,b)+(c?c:"")}}return this};new (function(){TbICom.call(this);var a=this;var e={_keyValues:[["贴吧投诉","http://tieba.baidu.com/tousu/new"],["帖吧投诉","http://tieba.baidu.com/tousu/new"],["tiebatousu","http://tieba.baidu.com/tousu/new"],["贴吧投诉吧","http://tieba.baidu.com/tousu/new"],["贴吧投诉中心","http://tieba.baidu.com/tousu/new"],["投诉中心","http://tieba.baidu.com/tousu/new"],["投诉","http://tieba.baidu.com/tousu/new"],["贴吧举报","http://tieba.baidu.com/tousu/new"],["知道投诉","http://tousu.baidu.com/zhidao"],["空间投诉","http://tousu.baidu.com/hi"],["百科投诉","http://tousu.baidu.com/baike"],["zhidaotousu","http://tousu.baidu.com/zhidao"],["kongjiantousu","http://tousu.baidu.com/hi"],["baiketousu","http://tousu.baidu.com/baike"]],go:function(k){var f=this._keyValues;var g=k.toLowerCase();for(var h=0;h<f.length;h++){if(g==f[h][0]){window.location.href=f[h][1];return true}}var j=TbUtil.DBC2SBC(k);if(/^\d{7,10}$/.test(j)){window.location.href="/club/"+j;return true}return false}};var d=function(g){var f=document.getElementById(g);return f&&f.checked};var b=function(f){return f.replace(/(^[\s\t\xa0\u3000]+)|([\u3000\xa0\s\t]+$)/g,"")};var c={escapeUTF8:function(f){return escape(String(f)).replace(/%u(\w{4})/g,function(g,h){return encodeURIComponent(String.fromCharCode("0x"+h)).replace(/%/g,"%25")})},countPV:function(g){var f=new Image();window["bd_pv_"+(new Date().getTime())]=f;f.src="http://static.tieba.baidu.com/tb/img/pv.gif?t="+new Date().getTime()+"&"+g},setWord:function(k,j){var h=b(document.f1.kw.value);if(h==""||c.isIndexPage()){var i=k.href.toString().match(/^(\w+:\/\/[^\/]+)/i);k.href=i&&i[1]+(h==""?"":"/?t=50&q="+encodeURIComponent(h))}else{if(j!=""){if(k.href.indexOf("www.baidu.com")>=0){var f="fr=tb01000&";if(window.location.href.match("ftype=guide")){f="fr=tb01se0&"}var g=k.href.indexOf("fr=");if(g>-1){k.href=k.href.substring(0,g)+f}else{k.href=k.href+f}}h=h.replace(/\%/gi,"%25").replace(/&/gi,"%26").replace(/\+/gi,"%2B").replace(/[\ \u3000]/gi,"%20").replace(/\//gi,"%2F").replace(/\#/gi,"%23").replace(/\=/gi,"%3D");var g=k.href.indexOf(j+"=");if(g>-1){k.href=k.href.substring(0,g)+j+"="+h}else{k.href=k.href+j+"="+h}}}a.dispatchEvent("setWord",j)},isIndexPage:function(){return/^\w+:\/\/[^\/]+\/(index\.html?)|(i\/\d+)/.test(window.location.href)},setVal:function(f,g){f.kw.value=g.kw},DBC2SBC:function(f){return TbUtil.DBC2SBC(f)},search:function(i,f){a.dispatchEvent("search",i);if(!f){f=""}if(b(i.kw.value)==""){window.location.href="http://tieba.baidu.com";return false}var g="/f";if(d("jointb"+f)){var h=c.searchTieba(i.kw.value);if(h===false){return h}}if(d("authortb"+f)){return c.searchItieba(i.kw.value)}if(d("searchtb"+f)){return c.searchWord(i.kw.value)}if(d("nametb"+f)){window.location.href="/f?ct=536870912&tn=searchPostListByName&rn=30&cm=1104rs2=3&ie=utf-8&kw="+encodeURIComponent(i.kw.value);return false}if(d("nowtb"+f)){window.location.href="/f/search/res?ie=utf-8&kw="+encodeURIComponent(PageData.present_forum.unescapeHTML())+"&qw="+encodeURIComponent(i.kw.value);return false}i.action=g;return true},searchItieba:function(f){window.location.href="/i/sys/enter?ie=utf-8&kw="+encodeURIComponent(f);return false},searchTieba:function(f){var g=b(f);if(e.go(g)){return false}},searchWord:function(f){$.tb.post("/data/searchhistory?method=add_word&ie=UTF-8",{word:f},function(){});setTimeout(function(){window.location.href="/f/search/res?ie=utf-8&qw="+encodeURIComponent(f)},100);return false}};this.initSys("Search",[],{headSetWord:c.setWord,headSetVal:c.setVal,headSearch:c.search,headSearchTieba:c.searchTieba,headSearchITieba:c.searchItieba,headSearchWord:c.searchWord})})();var NsLogLinker={_pid:0,stat:function(d,b){var f="nslog__"+(new Date()).getTime();var e=window[f]=new Image();var a=b||this._pid;e.onload=(e.onerror=function(){window[f]=null});e.src="http://nsclick.baidu.com/v.gif?pid="+a+"&url="+encodeURIComponent(d)+"&t="+(new Date()).getTime()+"&type=0";e=null},_checkEvent:function(c){c=c||event;var b=c.srcElement||c.target;if(b.nodeType!=1){b=b.parentNode}while(b&&b.tagName&&b.tagName.toUpperCase()!="A"){b=b.parentNode}if(b&&b.tagName&&b.tagName.toUpperCase()=="A"){if(!/^([\w-]+\.)*?baidu\.com/i.test(b.host)){var a=b.href;setTimeout(function(){NsLogLinker.stat(a)},1)}}b=null},isOutLink:function(a){return(!/([\w-]+\.)*?baidu\.com/i.test(a))},bind:function(a){this._pid=a;if(document.attachEvent){document.attachEvent("onmousedown",this._checkEvent);window.attachEvent("onunload",function(){document.detachEvent("onmousedown",NsLogLinker._checkEvent)})}else{document.addEventListener("mousedown",this._checkEvent,false);window.addEventListener("unload",function(){document.removeEventListener("mousedown",NsLogLinker._checkEvent,false)},false)}}};window.baidu=window.baidu||{version:"1-0-0",emptyFn:function(){}};baidu.swf=baidu.swf||{};baidu.isString=function(a){return(typeof a=="object"&&a&&a.constructor==String)||typeof a=="string"};baidu.swf.getVersion=function(){var h=navigator;if(h.plugins&&h.mimeTypes.length){var b=h.plugins["Shockwave Flash"];if(b&&b.description){return b.description.replace(/([a-zA-Z]|\s)+/,"").replace(/(\s)+r/,".")+".0"}}else{if(window.ActiveXObject&&!window.opera){for(var d=10;d>=2;d--){try{var g=new ActiveXObject("ShockwaveFlash.ShockwaveFlash."+d);if(g){return d+".0.0";break}}catch(f){}}}}};baidu.swf.createHTML=function(r){r=r||{};var h=baidu.swf.getVersion(),q=1;var f=r.ver||"6.0.0",e,c;if(h){h=h.split(".");f=f.split(".");for(var d=0;d<3;d++){e=parseInt(h[d],10);c=parseInt(f[d],10);if(c<e){break}else{if(c>e){q=0;break}}}}else{q=0}if(!q){return""}var l=r.vars;var d,b,g,p;var j=["classid","codebase","id","width","height","align"];r.align=r.align||"middle";r.classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000";r.codebase="http://fpdownload.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,0,0";r.movie=r.url||"";delete r.vars;delete r.url;if(baidu.isString(l)){r.flashvars=l}else{var n=[];for(b in l){p=l[b];if(p){n.push(b+"="+encodeURIComponent(p))}}r.flashvars=n.join("&")}var m=["<object "];for(d=0,g=j.length;d<g;d++){p=j[d];m.push(" ",p,'="',r[p],'"')}m.push(">");var a={wmode:1,scale:1,quality:1,play:1,loop:1,menu:1,salign:1,bgcolor:1,base:1,allowscriptaccess:1,allownetworking:1,allowfullscreen:1,seamlesstabbing:1,devicefont:1,swliveconnect:1,flashvars:1,movie:1};for(b in r){p=r[b];if(a[b]&&p){m.push('<param name="'+b+'" value="'+p+'" />')}}r.src=r.movie;r.name=r.id;delete r.id;delete r.movie;delete r.classid;delete r.codebase;r.type="application/x-shockwave-flash";r.pluginspage="http://www.macromedia.com/go/getflashplayer";m.push("<embed");var o;for(b in r){p=r[b];if(p){if((new RegExp("^salign\x24","i")).test(b)){o=p;continue}m.push(" ",b,'="',p,'"')}}if(o){m.push(' salign="',o,'"')}m.push("></embed></object>");return m.join("")};baidu.swf.create=function(a,d){a=a||{};var b=baidu.swf.createHTML(a);var c=true;if(d&&baidu.isString(d)){d=document.getElementById(d)}if(b.length<=0){b=a.errorMessage||"";c=false}if(d){d.innerHTML=b}return c};baidu.swf.getMovie=function(a){return document[a]||window[a]};var CaptchaCom=function(b,a){this.init(b,a)};CaptchaCom.DEFAULT_OPTIONS={imgUrl:"/cgi-bin/genimg?",audioUrl:"/cgi-bin/genaudio?",inputFocusClass:"c_captcha_focus",onInputFocus:null,onInputBlur:null,beforeImgInit:null,afterImgInit:null,template:'<div class="clearfix"><div class="c_captcha_input_con j_input_con"><input style="ime-mode:disabled " autocomplete="off" size="10" maxlength="10" class="c_captcha_input_normal j_captcha_input" ></div><div class="c_captcha_sub_wrap j_captcha_content clearfix" style="display:none;"><div class="c_captcha_img j_captcha_img_wrapper"></div><div class="c_captcha_a"><a class="j_captcha_img_change"  >看不清?</a>&nbsp;<a class="c_captcha_a_audio j_captcha_audio_switch" >收听验证码</a></div><div class="c_captcha_audio"><img class="j_captcha_audio_icon c_captcha_audio_img" src="http://tieba.baidu.com/tb/img/audio.gif" /><span class="j_captcha_audio_wrapper"></span></div></div></div><div class="c_captcha_tip j_captcha_tip">请点击后输入验证码</div><div class="c_captcha_error j_captcha_err"></div>'};CaptchaCom.prototype={init:function(c,a){this.captchaReq=c;this.options=$.extend({},CaptchaCom.DEFAULT_OPTIONS,a);this.initialized=false;this.needUpdate=true;this.j_container=$(a.container);var b=$(this.options.template);this.j_container.html(b);this.j_content=this.j_container.find(".j_captcha_content");this.j_input=this.j_container.find(".j_captcha_input");this.j_tip=this.j_container.find(".j_captcha_tip");this.j_error=this.j_container.find(".j_captcha_err");this.j_imgWrapper=this.j_container.find(".j_captcha_img_wrapper");this.j_imgChangeBtn=this.j_container.find(".j_captcha_img_change");this.j_switchAudioBtn=this.j_container.find(".j_captcha_audio_switch");this.j_audioIcon=this.j_container.find(".j_captcha_audio_icon");this.j_audioWrapper=this.j_container.find(".j_captcha_audio_wrapper");this._initEvents()},_initEvents:function(){var a=this;this.j_imgChangeBtn.click(function(){a.reload();return false});this.j_switchAudioBtn.click(function(){a.getAudio();return false});this.j_input.blur(function(b){$(this).removeClass(a.options.inputFocusClass);if(a.options.onInputBlur){a.options.onInputBlur.call(this,b,a)}a.reset()});this.j_input.focus(function(b){$(this).addClass(a.options.inputFocusClass);if(a.options.onInputFocus){a.options.onInputFocus.call(this,b,a)}if(a.initialized===false){if(a.options.beforeImgInit){a.options.beforeImgInit.call(a)}a.updateCaptchaImg();a.initialized=true;if(a.options.afterImgInit){a.options.afterImgInit.call(a)}}})},changeContent:function(a){if(a=="loginUser"){if(this.captchaReq.answer.showShenshou==1&&this.captchaReq.answer.open_by_spam!=1){this.j_tip.text("为抵御爆吧挖坟，吧主设置本吧"+this.captchaReq.answer.shenshou_lv+"级以下用户暂时需要输入中文验证码")}else{this.j_tip.text("请点击后输入验证码")}}else{if(this.captchaReq.answer.showShenshou==1&&this.captchaReq.answer.open_by_spam!=1){this.j_tip.text("为抵御爆吧挖坟，吧主设置本吧"+this.captchaReq.answer.shenshou_lv+"级以下用户暂时需要输入中文验证码")}else{this.j_tip.text("请点击后输入验证码，匿名发贴需要输入验证码")}}},getAudio:function(){this.needUpdate=false;this.j_audioIcon.show();var a=this.options.audioUrl+this.signStr+"&t="+Math.random();if(!document.all){this.j_audioWrapper.html('<embed src="'+a+'" name="MediaPlayer" type="video/x-ms-wmv" autostart="1" showcontrols="1" allowscan="1" playcount="1" enablecontextmenu="0" height="0" width="0"></object>')}else{this.j_audioWrapper.html('<object height=0 width=0 classid=CLSID:6BF52A52-394A-11d3-B153-00C04F79FAA6><param name="AutoStart" value="1"><param NAME="url" value="'+a+'"><param name="PlayCount" value="1">')}this.j_input.focus()},_getData:function(){this.captchaReq.antiProcess();var b=this.captchaReq.getVcodeUrl()+"&t="+Math.random();var a=this;$.ajax({url:b,dataType:"json",success:function(d){var c=d.data;a.signStr=c.vcodestr},async:false})},validCaptcha:function(){var a=this.j_input.val();this.captchaReq.antiProcess();if(this.captchaReq.needCaptcha){if(a==null||a.length==0){this.j_error.text("验证码不能为空，请输入验证码").show();this.j_input.focus();return false}}return true},getInputValue:function(){return this.j_input.val().replace(/\s/g,"")},changeYImg:function(a){a.src="http://static.tieba.baidu.com/tb/img/errorYimg.jpg"},updateCaptchaImg:function(){if(!this.needUpdate){return}var a=this;this.needUpdate=false;this._getData();var c=this.j_img;var b=this.options.imgUrl+this.signStr+"&t="+Math.random();if(!c){this.j_imgWrapper.html('<img src="'+b+'" style="cursor: pointer;">');this.j_img=this.j_imgWrapper.find("img").click(function(){a.reload()})}else{c.attr("src",b)}this.j_content.show()},reload:function(){this.reset();this.updateCaptchaImg()},updateImage:function(){this.needUpdate=false;this.j_input.val("").focus();var a=this.imgUrl+this.signStr+"&t="+Math.random();this.j_img.attr("src",a)},show:function(){if(this.captchaReq.answer.showShenshou==1){if(this.captchaReq.answer.open_by_spam==1){this.j_tip.text("请点击后输入验证码")}else{this.j_tip.text("为抵御爆吧挖坟，吧主设置本吧"+this.captchaReq.answer.shenshou_lv+"级以下用户暂时需要输入中文验证码")}this.j_input.css("imeMode","active");this.j_switchAudioBtn.hide()}this.j_container.show()},hide:function(){this.j_container.hide();this.j_input.val("");this.j_error.html("")},focus:function(){this.j_input.focus()},clear:function(){this.j_input.val("")},reset:function(){this.needUpdate=true},showErrorTip:function(a){this.j_error.text(a).show()},hideErrorTip:function(){this.j_error.hide().html("")}};var CaptchaReqCom=function(b,a){this.needCaptcha=false;this.isPosting=false;this.isAnonymous=false;this.answer={antiNeedVerify:null,antiNeedVerifyAnonymous:null};this.postType="thread";this.url=a||"/f/user/json_needvcode";this.forumName=b.forumName;this.forumId=b.forumId;if(b.postType=="reply"){this.postType="reply";if(b.tid){this.tid=b.tid}}this.async=true;if(b.async===false){this.async=false}delete b.forumName;delete b.forumId;delete b.postType;delete b.tid;delete b.async;this.params=b};CaptchaReqCom.prototype={_ifHasKnowAnti:function(){if(this.isAnonymous){return !(this.answer.antiNeedVerifyAnonymous==null)}else{return !(this.answer.antiNeedVerify==null)}},setVcodeUrl:function(a){if(this.isAnonymous){this.answer.vcodeUrlAnonymous=a}else{this.answer.vcodeUrl=a}},getVcodeUrl:function(){if(this.isAnonymous){return this.answer.vcodeUrlAnonymous}else{return this.answer.vcodeUrl}},_getAntiAnswer:function(c){var a=this;var b={rs1:this.isAnonymous?"1":"0",rs10:this.postType=="thread"?"1":"0",lm:this.forumId,word:this.forumName,t:Math.random()};if(this.tid){b.tid=this.tid}this.isPosting=true;$.ajax({url:a.url,data:b,async:a.async,dataType:"json",success:function(d){a.handleAnswer(d.data);c();a.isPosting=false}})},handleAnswer:function(a){if(this.isAnonymous){this.answer.antiNeedVerifyAnonymous=a.need}else{this.answer.antiNeedVerify=a.need}this.answer.showShenshou=a.open_shenshou;if(a.open_shenshou==1){this.answer.shenshou_lv=a.shenshou_lv;this.answer.open_by_spam=a.open_by_spam}if(this.tid){a.vcodeUrl+="&tid="+this.tid}this.setVcodeUrl(a.vcodeUrl)},setData:function(a,b){this.params[a]=b},antiProcess:function(d){if(!this.isPosting){var b=this;var c="";var a=function(){if(b.isAnonymous){c=b.answer.antiNeedVerifyAnonymous}else{c=b.answer.antiNeedVerify}b.needCaptcha=c=="1";if(d){d(b.needCaptcha)}};if(this._ifHasKnowAnti()){a()}else{this._getAntiAnswer(a)}}},reload:function(){this.answer.antiNeedVerifyAnonymous=null;this.answer.antiNeedVerify=null},getCaptchaInstance:function(a){return new CaptchaCom(this,a)}};